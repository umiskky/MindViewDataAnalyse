(function(e){function t(t){for(var r,i,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&m.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],r=!0,o=1;o<s.length;o++){var l=s[o];0!==a[l]&&(r=!1)}r&&(n.splice(t--,1),e=i(i.s=s[0]))}return e}var r={},a={app:0},n=[];function i(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=r,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},"56d7":function(e,t,s){"use strict";s.r(t);var r={};s.r(r),s.d(r,"getCurrentPage",(function(){return J})),s.d(r,"getCurrentUser",(function(){return H})),s.d(r,"getUserList",(function(){return Z}));var a={};s.r(a),s.d(a,"getUserList",(function(){return G})),s.d(a,"deleteUser",(function(){return W})),s.d(a,"queryUserByName",(function(){return X})),s.d(a,"queryUserByNum",(function(){return ee})),s.d(a,"updateUser",(function(){return te})),s.d(a,"insertUser",(function(){return se})),s.d(a,"getRecordByNumber",(function(){return re})),s.d(a,"getReportByRid",(function(){return ae})),s.d(a,"getAllRecords",(function(){return ne})),s.d(a,"deleteRecord",(function(){return ie})),s.d(a,"deleteRecordData",(function(){return oe})),s.d(a,"deleteReport",(function(){return le})),s.d(a,"uploadFile",(function(){return ce})),s.d(a,"uploadMultiPersonnel",(function(){return ue})),s.d(a,"deleteMultiUser",(function(){return de}));s("e260"),s("e6cf"),s("cca6"),s("a79d"),s("4de4"),s("4d90"),s("99af");var n=s("2b0e"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("vue-canvas-nest",{attrs:{config:{color:"76,110,245",count:200,opacity:1}}}),s("el-aside",{attrs:{width:"20%"}},[s("Aside",{staticStyle:{"margin-top":"100px"},attrs:{id:"aside"}})],1),s("el-container",[s("el-header",{staticStyle:{"margin-top":"10px",width:"80%"},attrs:{height:"70px"}},[s("div",[s("div",{staticStyle:{"line-height":"70px","font-size":"35px",float:"left","/*text-align":"center","*/\n                  font-family":"'PingFang SC'"}},[e._v(" "+e._s(e.title)+" ")]),"用户列表"===e.title?s("div",{staticClass:"header-right"},[s("el-input",{staticStyle:{display:"inline-block",width:"180px","margin-right":"10px"},attrs:{placeholder:"请输入姓名或学号","prefix-icon":"el-icon-search",size:"small",clearable:""},on:{change:e.onUserQuery},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),s("el-button",{staticStyle:{display:"inline-block","padding-bottom":"10px",height:"30px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.insertFormVisible=!0}}})],1):e._e(),"测试列表"===e.title?s("div",{staticClass:"header-right"},[s("el-input",{staticStyle:{display:"inline-block",width:"180px","margin-right":"10px"},attrs:{placeholder:"请输入姓名或学号","prefix-icon":"el-icon-search",size:"small",clearable:""},on:{change:e.onTestQuery},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),s("el-tooltip",{attrs:{content:e.decision,placement:"top"}},[s("el-switch",{attrs:{disabled:e.isDisabled,"active-color":"#409EFF","active-value":"通过用户列表形式展示测试记录","inactive-value":"直接枚举测试记录","active-icon-class":"el-icon-user-solid","inactive-icon-class":"el-icon-tickets"},on:{change:e.changeShowType},model:{value:e.decision,callback:function(t){e.decision=t},expression:"decision"}})],1)],1):e._e()]),s("el-divider",{attrs:{id:"divider"}})],1),s("el-main",{staticStyle:{"overflow-y":"hidden"}},[s("div",{attrs:{id:"main-body"}},[s("router-view")],1)])],1),s("el-dialog",{attrs:{title:"添加用户",visible:e.insertFormVisible},on:{"update:visible":function(t){e.insertFormVisible=t},close:e.onCLose}},[e.isMultiple?e._e():s("el-form",{ref:"insertForm",attrs:{model:e.insertForm,rules:e.insertRules}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入被测者姓名"},model:{value:e.insertForm.name,callback:function(t){e.$set(e.insertForm,"name",t)},expression:"insertForm.name"}})],1),s("el-form-item",{attrs:{label:"编号",prop:"number"}},[s("el-input",{attrs:{tyoe:"text",placeholder:"请输入被测者编号"},model:{value:e.insertForm.number,callback:function(t){e.$set(e.insertForm,"number",t)},expression:"insertForm.number"}})],1),s("el-form-item",{attrs:{label:"性别",prop:"sex"}},[s("el-radio",{attrs:{label:"1"},model:{value:e.insertForm.sex,callback:function(t){e.$set(e.insertForm,"sex",t)},expression:"insertForm.sex"}},[e._v("男")]),s("el-radio",{attrs:{label:"0"},model:{value:e.insertForm.sex,callback:function(t){e.$set(e.insertForm,"sex",t)},expression:"insertForm.sex"}},[e._v("女")])],1),s("el-form-item",{attrs:{label:"年龄",prop:"age"}},[s("el-input",{attrs:{placeholder:"请输入1-3位数字"},model:{value:e.insertForm.age,callback:function(t){e.$set(e.insertForm,"age",t)},expression:"insertForm.age"}})],1)],1),e.isMultiple?s("el-upload",{ref:"upload",attrs:{"auto-upload":!1,action:"",multiple:"",accept:".xls,.xlsx"}},[s("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xls/xlsx文件,请提前确认当前文件内容格式是否符合要求！")])],1):e._e(),s("div",{attrs:{slot:"footer"},slot:"footer"},[e.isMultiple?e._e():s("el-button",{staticStyle:{float:"left"},attrs:{type:"text"},on:{click:e.onUpload}},[e._v("批量上传")]),e.isMultiple?s("el-button",{staticStyle:{float:"left"},attrs:{type:"text"},on:{click:e.onUpload}},[e._v("单独上传")]):e._e(),s("el-button",{on:{click:function(t){e.insertFormVisible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)],1)],1)},o=[],l=s("5530"),c=(s("b0c0"),s("429a")),u=s.n(c),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",[s("el-col",[s("el-button",{attrs:{icon:"el-icon-user-solid",circle:""},on:{click:function(t){e.onChangeTitle(0),e.onHandleClick(0)}}})],1),s("el-col",[s("el-button",{attrs:{icon:"el-icon-document",circle:""},on:{click:function(t){e.onChangeTitle(1),e.onHandleClick(1)}}})],1),s("el-col",[s("el-button",{attrs:{icon:"el-icon-menu",circle:""},on:{click:function(t){e.onChangeTitle(2),e.onHandleClick(2)}}})],1)],1)},m=[],p=(s("ac1f"),s("5319"),{name:"Aside",methods:{onChangeTitle:function(e){this.$store.commit("changeTitle",e)},onHandleClick:function(e){switch(e){case 0:this.$router.replace("/userList");break;case 1:this.$router.replace("/testList");break;default:this.$message({type:"warning",message:"敬请期待"});break}}}}),g=p,h=(s("b295"),s("2877")),f=Object(h["a"])(g,d,m,!1,null,"a8373356",null),y=f.exports,b={name:"App",components:{vueCanvasNest:u.a,Aside:y},computed:{title:function(){return this.$store.state.title},isQuery:function(){return this.$store.state.isQuery}},watch:{isQuery:function(e){this.isDisabled=!0===e}},data:function(){return{uploadList:[],isMultiple:!1,isDisabled:!1,decision:"通过用户列表形式展示测试记录",query:"",insertFormVisible:!1,insertForm:{},insertRules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{pattern:/^[1-9][0-9]{0,2}$/,message:"请输入1到3位非零数字",trigger:"blur"}],number:[{required:!0,message:"请输入被测者编号",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]}}},methods:{onUserQuery:function(){var e=this,t=this.query,s=/^[(\u4e00-\u9fa5)]+|[a-zA-Z]+$/gi,r=/^[a-zA-Z]?[0-9]+$/gi;r.test(t)?this.$store.dispatch("queryUserByNum",t).then((function(t){200===t.data.code?(e.$message({type:"success",message:"查询成功"}),e.$store.commit("queryUsers",t.data.data)):1005===t.data.code?e.$message({type:"warning",message:"查无此人"}):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})})):s.test(t)?this.$store.dispatch("queryUserByName",t).then((function(t){200===t.data.code?(e.$message({type:"success",message:"查询成功"}),e.$store.commit("queryUsers",t.data.data)):1005===t.data.code?e.$message({type:"warning",message:"查无此人"}):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})})):this.$store.dispatch("getUserList",{process:0,page:1}).then((function(t){var s=t.data.data;s.records.length<=0?e.$message({message:"已经没有更多数据了哦",type:"warning"}):e.$store.commit("initUserList",s)})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})}))},onTestQuery:function(){var e=this,t=this.query,s=/^[(\u4e00-\u9fa5)]+|[a-zA-Z]+$/gi,r=/^[a-zA-Z]?[0-9]+$/gi;r.test(t)?this.$store.dispatch("queryUserByNum",t).then((function(t){200===t.data.code?(e.$message({type:"success",message:"查询成功"}),e.$store.commit("queryUsers",t.data.data)):1005===t.data.code?e.$message({type:"warning",message:"查无此人"}):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})})):s.test(t)?this.$store.dispatch("queryUserByName",t).then((function(t){200===t.data.code?(e.$message({type:"success",message:"查询成功"}),e.$store.commit("queryUsers",t.data.data)):1005===t.data.code?e.$message({type:"warning",message:"查无此人"}):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})})):this.$store.dispatch("getUserList",{process:1,page:1}).then((function(t){var s=t.data.data;s.records.length<=0?e.$message({message:"已经没有更多数据了哦",type:"warning"}):e.$store.commit("initUserList",s)})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作?"})}))},onCLose:function(){this.isMultiple||this.$refs["insertForm"].resetFields()},submitForm:function(){var e=this;this.isMultiple?this.insertFormVisible=!1:this.$refs["insertForm"].validate((function(t){if(t){var s=Object(l["a"])({},e.insertForm);s.nature='{  "name": "'+e.insertForm.name+'"}',e.$delete(s,"name"),s.sex=parseInt(s.sex),s.age=parseInt(s.age),e.$store.dispatch("insertUser",s).then((function(t){200===t.data.code?(e.$message({type:"success",message:"添加成功"}),e.insertFormVisible=!1,e.$store.dispatch("queryUserByNum",s.number).then((function(t){if(200===t.data.code){var s=t.data.data[0];e.$store.commit("insertUser",s)}else e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误"})}))):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统出错"})}))}else e.$message({type:"error",message:"信息填写有误"})}))},changeShowType:function(){this.$store.commit("changeShowType")},onUpload:function(){this.isMultiple=!this.isMultiple},submitUpload:function(){var e=this,t=this.$refs.upload.uploadFiles,s=function(){var s=t.pop(),r=new FormData;r.append("multipartFile",s.raw),e.$store.dispatch("uploadFile",r).then((function(t){200===t.data.code?e.$store.dispatch("uploadMultiPersonnel",t.data.data).then((function(t){200===t.data.code?(e.init(),e.$message({type:"success",message:s.name+"上传成功"})):e.$message({type:"error",message:"用户信息上传失败"})})).catch((function(){e.$message({type:"error",message:"系统错误"})})):e.$message({type:"error",message:s.name+"上传失败"})})).catch((function(){e.$message({type:"error",message:"系统错误"})}))};while(t.length>0)s()},init:function(){var e=this;this.$router.push("/userList"),this.$store.dispatch("getUserList",{process:0,page:1}).then((function(t){var s=t.data.data;s.records.length<=0?e.$message({message:"已经没有更多数据了哦",type:"warning"}):e.$store.commit("initUserList",s)})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})}))}},created:function(){this.init()}},v=b,$=(s("034f"),Object(h["a"])(v,i,o,!1,null,null,null)),w=$.exports,L=s("5c96"),x=s.n(L),_=(s("0fae"),s("8c4f")),S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-col",[s("el-row",e._l(e.userList,(function(e){return s("UserCard",{key:e.id,staticStyle:{float:"left"},attrs:{user:e}})})),1),s("el-row",[e.isQuery?e._e():s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.totalPages,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentChange}}),e.isQuery?s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.queryPage,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentQueryChange}}):e._e()],1)],1)},k=[],F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-card",{attrs:{id:"box-card",shadow:"hover"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{attrs:{id:"header-text"}},[e._v(e._s(e.userInfo.name))]),s("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-delete",type:"danger",size:"mini",circle:""},on:{click:function(t){return t.stopPropagation(),e.onDelete(t)}}}),s("el-button",{staticStyle:{float:"right","margin-right":"7px"},attrs:{icon:"el-icon-edit",type:"primary",size:"mini",circle:""},on:{click:function(t){return e.onEdit(t)}}})],1),s("div",[s("el-col",{nativeOn:{click:function(t){return e.showDetail.apply(null,arguments)}}},[s("el-row",{staticClass:"info-text"},[s("span",[e._v("学号： "+e._s(e.userInfo.number))])]),s("el-row",{staticClass:"info-text"},[s("span",[e._v("性别： "+e._s(e.userInfo.sex))])]),s("el-row",{staticClass:"info-text",attrs:{id:"last-info"}},[s("span",[e._v("年龄： "+e._s(e.userInfo.age))])])],1)],1),s("el-dialog",{attrs:{title:"修改用户信息",visible:e.editFormVisible},on:{"update:visible":function(t){e.editFormVisible=t},close:e.onClose}},[s("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{type:"text"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),s("el-form-item",{attrs:{label:"编号",prop:"number"}},[s("el-input",{attrs:{disabled:""},domProps:{innerHTML:e._s(e.user.number)}})],1),s("el-form-item",{attrs:{label:"性别",prop:"sex"}},[s("el-radio",{attrs:{label:"1"},model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}},[e._v("男")]),s("el-radio",{attrs:{label:"0"},model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}},[e._v("女")])],1),s("el-form-item",{attrs:{label:"年龄",prop:"age"}},[s("el-input",{attrs:{placeholder:"editForm.age"},model:{value:e.editForm.age,callback:function(t){e.$set(e.editForm,"age",t)},expression:"editForm.age"}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")])],1)],1),s("el-drawer",{attrs:{title:"测试结果",visible:e.detailCardVisible,direction:"rtl","before-close":e.beforeClose,size:"60%"},on:{"update:visible":function(t){e.detailCardVisible=t}}},[e.isEmpty?e._e():s("el-col",[s("el-row",[s("div",{staticStyle:{"margin-left":"20px","margin-bottom":"20px"}},[e._v(" 开始时间："+e._s(this.showBgTime)+" -- 结束时间："+e._s(this.showEdTime)+" ")])]),s("el-row",e._l(e.showImgList,(function(t,r){return s("el-col",{key:t,staticStyle:{"margin-bottom":"25px"},attrs:{offset:r<=1||r>=3?2:4,span:r<=1||r>=3?9:16}},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("el-image",{staticClass:"image",attrs:{src:t,"preview-src-list":e.showImgList.slice(r,r+1)}}),s("div",{staticStyle:{padding:"14px"}},[s("span",[e._v("测试结果"+e._s(r))])])],1)],1)})),1),s("el-row",[s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.showPage,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleShowChange}})],1)],1),e.isEmpty?s("el-empty"):e._e()],1)],1)},C=[],U=(s("d3b7"),s("25f0"),s("a434"),s("4e82"),{name:"UserCard",data:function(){return{userInfo:{name:"",number:"",sex:"",age:""},editFormVisible:!1,editForm:{},editRules:{name:[{required:!0,message:"请输入用户姓名",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"}]},isEmpty:!0,detailCardVisible:!1,showImgList:[],showRecordList:[],showPage:0,showBgTime:"",showEdTime:""}},props:{user:{type:Object,required:!0}},watch:{user:{handler:function(e,t){this.userInfo.number=e.number,this.judgeSex(e.sex.toString()),this.userInfo.age=e.age,this.userInfo.name=e.nature&&JSON.parse(this.user.nature).name,this.editForm=Object(l["a"])({},this.userInfo),this.editForm.sex=e.sex.toString()},deep:!0,immediate:!0}},methods:{onEdit:function(e){this.editFormVisible=!0,e.stopPropagation()},onDelete:function(e){var t=this;e.stopPropagation(),this.$store.dispatch("getRecordByNumber",this.user.number).then((function(e){2001===e.data.code?t.$confirm("此操作将永久删除当前用户信息与数据，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("deleteUser",t.user.number).then((function(e){200===e.data.code?(t.$store.commit("deleteUser",t.user.number),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"error",message:"删除失败"})}))})).catch((function(){t.$message({type:"info",message:"已取消操作"})})):200===e.data.code?t.$alert("当前用户仍存在测试记录，请清理完毕后再进行操作"):t.$message({type:"warning",message:"出错了"})})).catch((function(){t.$message({type:"error",message:"系统错误"})}))},onClose:function(){this.$refs["editForm"].resetFields()},submitForm:function(){var e=this;this.$refs["editForm"].validate((function(t){if(t){var s=Object(l["a"])({},e.editForm);s.nature='{  "name": "'+e.editForm.name+'"}',e.$delete(s,"name"),s.sex=parseInt(s.sex),s.age=parseInt(s.age),s.timestamp=(new Date).getTime(),s.id=e.user.id,e.$store.dispatch("updateUser",s).then((function(t){200===t.data.code?(e.$message({type:"success",message:"修改成功"}),e.$store.commit("updateUser",s),e.userInfo.name=e.editForm.name,e.judgeSex(e.editForm.sex),e.editFormVisible=!1):e.$message({type:"error",message:t.data.message})})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})}))}else e.$message({type:"error",message:"信息填写有误"})}))},beforeClose:function(){this.isEmpty=!0,this.detailCardVisible=!1},handleShowChange:function(e){var t=this;this.showImgList.splice(0,this.showImgList.length),this.showBgTime=this.showRecordList[e-1].start,this.showEdTime=this.showRecordList[e-1].end,this.$store.dispatch("getReportByRid",this.showRecordList[e-1].id).then((function(e){200===e.data.code?(t.isEmpty=!1,t.showImgList=JSON.parse(JSON.stringify(e.data.data.reverse()))):t.$message({type:"info",message:"该用户没有评测结果"})}))},showDetail:function(){var e=this,t=this.user;this.detailCardVisible=!0,this.showRecordList.splice(0,this.showRecordList.length),this.showImgList.splice(0,this.showImgList.length),this.$store.dispatch("getRecordByNumber",t.number).then((function(t){if(200===t.data.code){e.isEmpty=!1;var s=t.data.data;e.showRecordList=s.filter((function(e){return 3===e.record&&1===e.tag})),e.sortKey(e.showRecordList,"unixstart"),e.showPage=e.showRecordList.length,e.showRecordList.length>0&&(e.showBgTime=e.showRecordList[0].start,e.showEdTime=e.showRecordList[0].end,e.$store.dispatch("getReportByRid",e.showRecordList[0].id).then((function(t){200===t.data.code?e.showImgList=JSON.parse(JSON.stringify(t.data.data.reverse())):e.$message({type:"info",message:"当前评测结果为空"})})))}else 2001===t.data.code?e.$message({type:"info",message:"当前用户暂时没有测试数据"}):e.$message({type:"warning",message:"出错了"})}))},judgeSex:function(e){this.userInfo.sex="1"===e?"男":"女"},sortKey:function(e,t){return e.sort((function(e,s){var r=e[t],a=s[t];return r<a?-1:r>a?1:0}))}},created:function(){this.userInfo.name=this.user.nature&&JSON.parse(this.user.nature).name,this.judgeSex(this.user.sex.toString());var e={};e.name=this.userInfo.name,e.number=this.user.number,e.sex=this.user.sex.toString(),e.age=this.user.age,this.editForm=Object(l["a"])({},e)}}),R=U,D=(s("d5f1"),Object(h["a"])(R,F,C,!1,null,"2c9557ca",null)),q=D.exports,j={name:"UserList",components:{UserCard:q},data:function(){return{isEmpty:!0,detailCardVisible:!1,showImgList:[],showRecordList:[],showPage:0}},computed:{queryPage:function(){return this.$store.state.queryPage},isQuery:function(){return this.$store.state.isQuery},userList:function(){return this.$store.state.userList},totalPages:function(){return this.$store.state.totalPages}},methods:{handleCurrentChange:function(e){var t=this;this.$store.dispatch("getUserList",{process:0,page:e}).then((function(e){var s=e.data.data.records;s.length<=0?t.$message({message:"已经没有更多数据了哦",type:"warning"}):t.$store.commit("changeUserList",s)}))},handleCurrentQueryChange:function(e){this.$store.commit("showQueryList",e)}},created:function(){var e=this;this.$store.dispatch("getUserList",{process:0,page:1}).then((function(t){var s=t.data.data;s.records.length<=0?e.$message({message:"已经没有更多数据了哦",type:"warning"}):e.$store.commit("initUserList",s)})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})}))}},I=j,T=Object(h["a"])(I,S,k,!1,null,"88a2470e",null),P=T.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.showUser?s("el-col",[s("el-row",{staticStyle:{"margin-bottom":"5px"}},[s("el-col",{attrs:{span:2}},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate,label:"全选"},on:{change:e.selectAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}})],1),s("el-col",{attrs:{span:3}},[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",disabled:e.isEmpty},on:{click:e.multiDelete}})],1)],1),s("el-row",[s("el-collapse",{attrs:{accordion:""},on:{change:e.handleCollapseChange},model:{value:e.activeNum,callback:function(t){e.activeNum=t},expression:"activeNum"}},e._l(e.userList,(function(t){return s("el-collapse-item",{key:t.number,attrs:{name:t.number}},[s("template",{slot:"title"},[s("el-checkbox-group",{on:{change:e.isSelect},model:{value:e.checkedList,callback:function(t){e.checkedList=t},expression:"checkedList"}},[s("el-checkbox",{attrs:{label:t.number},nativeOn:{click:function(t){return e.stopDefault(t)}}})],1),s("div",{staticClass:"collapse-title"},[e._v(e._s(JSON.parse(t.nature).name))])],1),s("el-table",{staticStyle:{width:"100%"},attrs:{border:"","max-height":"500",data:e.tableData}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[s("el-form-item",{staticClass:"el-form-item",staticStyle:{width:"100%"},attrs:{label:"测试id"}},[s("span",[e._v(e._s(t.row.id))])]),s("el-form-item",{attrs:{label:"测试进程"}},[s("span",[e._v(e._s(e.judgeRecord(t.row.record)))])]),s("el-form-item",{attrs:{label:"进程结果"}},[s("span",[e._v(e._s(e.judgeTag(t.row.tag)))])]),s("el-form-item",{attrs:{label:"开始时间"}},[s("span",[e._v(e._s(t.row.start))])]),s("el-form-item",{attrs:{label:"结束时间"}},[s("span",[e._v(e._s(t.row.end))])]),3===t.row.record&&1===t.row.tag?s("el-form-item",{staticStyle:{width:"100%"}},[s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},nativeOn:{click:function(s){return e.showDetail(t.row.id)}}},[e._v("详细结果")])],1):e._e()],1)]}}],null,!0)}),s("el-table-column",{attrs:{label:"测试id",prop:"id"}}),s("el-table-column",{attrs:{label:"测试进程",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.judgeRecord(t.row.record)))])]}}],null,!0)}),s("el-table-column",{attrs:{label:"进程结果",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:1===t.row.tag?"success":3===t.row.tag?"info":"danger"}},[e._v(e._s(e.judgeTag(t.row.tag)))])]}}],null,!0)}),s("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.onDelete(t.row)}}},[e._v("删除")])]}}],null,!0)})],1)],2)})),1)],1),s("el-row",[e.isQuery?e._e():s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.totalPages,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentChange}}),e.isQuery?s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.queryPage,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentQueryChange}}):e._e()],1)],1):e._e(),e.showUser?e._e():s("el-col",[s("el-row",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.recordList}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[s("el-form-item",{staticClass:"el-form-item",staticStyle:{width:"100%"},attrs:{label:"测试id"}},[s("span",[e._v(e._s(t.row.id))])]),s("el-form-item",{attrs:{label:"测试进程"}},[s("span",[e._v(e._s(e.judgeRecord(t.row.record)))])]),s("el-form-item",{attrs:{label:"进程结果"}},[s("span",[e._v(e._s(e.judgeTag(t.row.tag)))])]),s("el-form-item",{attrs:{label:"开始时间"}},[s("span",[e._v(e._s(t.row.start))])]),s("el-form-item",{attrs:{label:"结束时间"}},[s("span",[e._v(e._s(t.row.end))])]),3===t.row.record&&1===t.row.tag?s("el-form-item",{staticStyle:{width:"100%"}},[s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},nativeOn:{click:function(s){return e.showDetail(t.row.id)}}},[e._v("详细结果")])],1):e._e()],1)]}}],null,!1,2575024682)}),s("el-table-column",{attrs:{label:"测试id",prop:"id"}}),s("el-table-column",{attrs:{label:"测试进程",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.judgeRecord(t.row.record)))])]}}],null,!1,1949838110)}),s("el-table-column",{attrs:{label:"进程结果",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:1===t.row.tag?"success":3===t.row.tag?"info":"danger"}},[e._v(e._s(e.judgeTag(t.row.tag)))])]}}],null,!1,1731369156)}),s("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.onDelete(t.row)}}},[e._v("删除")])]}}],null,!1,137257069)})],1)],1),s("el-row",[e.isQuery?e._e():s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.totalPages,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentRecordChange}}),e.isQuery?s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"hide-on-single-page":"","page-count":e.queryPage,layout:"prev,pager,next,jumper"},on:{"current-change":e.handleCurrentQueryChange}}):e._e()],1)],1),s("el-drawer",{attrs:{title:"测试结果",visible:e.detailCardVisible,direction:"rtl","before-close":e.beforeClose,size:"60%"},on:{"update:visible":function(t){e.detailCardVisible=t}}},[s("el-row",e._l(e.showImgList,(function(t,r){return s("el-col",{key:t,staticStyle:{"margin-bottom":"25px"},attrs:{offset:r<=1||r>=3?2:4,span:r<=1||r>=3?9:16}},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("el-image",{staticClass:"image",attrs:{src:t,"preview-src-list":e.showImgList.slice(r,r+1)}}),s("div",{staticStyle:{padding:"14px"}},[s("span",[e._v("测试结果"+e._s(r))])])],1)],1)})),1)],1)],1)},N=[],Q=s("1da1"),B=(s("96cf"),{name:"TestList",data:function(){return{checkAll:!1,isIndeterminate:!1,activeNum:"",detailCardVisible:!1,showImgList:[],isEmpty:!0,checkedList:[],unableList:[]}},computed:{userList:function(){return this.$store.state.userList},tableData:function(){return this.$store.state.tableData},isQuery:function(){return this.$store.state.isQuery},totalPages:function(){return this.$store.state.totalPages},queryPage:function(){return this.$store.state.queryPage},showUser:function(){return this.$store.state.showUser},recordList:function(){return this.$store.state.recordList},numberList:function(){return this.$store.state.numberList},canDelete:function(){return this.$store.state.canDelete}},watch:{checkedList:function(e){e.length>0?this.isEmpty=!1:this.isEmpty=!0},showUser:function(e){var t=this;!0!==e||this.isQuery()?!1===e&&this.$store.dispatch("getAllRecords","1").then((function(e){var s=e.data.data;s.records.length<=0?t.$message({message:"已经没有更多数据了哦",type:"warning"}):t.$store.commit("initRecordList",s)})).catch((function(){t.$message({type:"error",message:"系统错误，已取消操作"})})):this.$store.dispatch("getUserList",{process:1,page:1}).then((function(e){var s=e.data.data;s.records.length<=0?t.$message({message:"已经没有更多数据了哦",type:"warning"}):(t.$store.commit("initUserList",s),t.activeNum=t.userList[0].number.toString(),t.$store.dispatch("getRecordByNumber",t.userList[0].number.toString()).then((function(e){200===e.data.code?t.$store.commit("changeTableData",e.data.data):2001===e.data.code?t.$message({type:"info",message:"当前用户暂时没有测试数据"}):t.$message({type:"warning",message:"出错了"})})))})).catch((function(){t.$message({type:"error",message:"系统错误，已取消操作"})}))},userList:function(){this.isIndeterminate=!1,this.$store.commit("setNumberList")}},methods:{judgeRecord:function(e){switch(e){case 0:return"暂无进程";case 1:return"主界面";case 2:return"眼动校准";case 3:return"评测";case 4:return"干预";case 5:return"放松";default:return"数据失效"}},judgeTag:function(e){switch(e){case 0:return"暂无结果";case 1:return"成功";case 2:return"错误";case 3:return"停止";default:return"数据失效"}},handleCollapseChange:function(e){var t=this;e&&(this.$store.commit("clearTableData"),this.$store.dispatch("getRecordByNumber",e).then((function(e){200===e.data.code?t.$store.commit("changeTableData",e.data.data):2001===e.data.code?t.$message({type:"info",message:"当前用户暂时没有测试数据"}):t.$message({type:"warning",message:"出错了"})})))},beforeClose:function(){this.detailCardVisible=!1},showDetail:function(e){var t=this;this.detailCardVisible=!0,this.showImgList.splice(0,this.showImgList.length),this.$store.dispatch("getReportByRid",e).then((function(e){200===e.data.code?t.showImgList=JSON.parse(JSON.stringify(e.data.data.reverse())):t.$message({type:"info",message:"当前评测结果为空"})}))},handleCurrentChange:function(e){var t=this;this.$store.dispatch("getUserList",{process:1,page:e}).then((function(e){var s=e.data.data.records;s.length<=0?t.$message({message:"已经没有更多数据了哦",type:"warning"}):t.$store.commit("changeUserList",s)}))},handleCurrentRecordChange:function(e){var t=this;this.$store.dispatch("getAllRecords",e).then((function(e){var s=e.data.data.records;s.length<=0?t.$message({message:"已经没有更多数据了哦",type:"warning"}):t.$store.commit("changeRecordList",s)}))},handleCurrentQueryChange:function(e){this.$store.commit("showQueryList",e)},onDelete:function(e){var t=this,s=e.id;this.$store.dispatch("deleteReport",s).then((function(e){200===e.data.code?t.$store.dispatch("deleteRecordData",s).then((function(e){200===e.data.code?t.$store.dispatch("deleteRecord",s).then((function(e){var r;200===e.data.code?(r=t.showUser?"tableData":"recordList",t.$store.commit("deleteRecord",{rid:s,list:r}),t.$message({type:"success",message:"删除成功"})):t.$message({type:"error",message:"删除报告失败"})})).catch((function(){t.$message({type:"error",message:"删除报告失败"})})):t.$message({type:"error",message:"删除测试数据失败"})})).catch((function(){t.$message({type:"error",message:"删除测试数据失败"})})):t.$message({type:"error",message:"删除测试记录失败"})})).catch((function(){t.$message({type:"error",message:"删除测试记录失败"})}))},isSelect:function(e){var t=e.length;this.checkAll=t===this.userList.length,this.isIndeterminate=t>0&&t<this.userList.length},selectAll:function(e){this.checkedList=e?this.numberList:[],this.isIndeterminate=!1},stringJoint:function(e){var t=e.pop();while(e.length>0)t+="、"+e.pop();return t},judgeDelete:function(e){var t=this;return Object(Q["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.$store.dispatch("getRecordByNumber",e).then((function(s){if(2001===s.data.code);else 200===s.data.code?(t.unableList.push(e),t.$store.commit("setFalse")):(t.$message({type:"warning",message:"出错了"}),t.$store.commit("setFalse"))})).catch((function(){t.$message({type:"error",message:"系统错误"}),t.$store.commit("setFalse")}));case 2:case"end":return s.stop()}}),s)})))()},multiDelete:function(){var e=this;return Object(Q["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=0;case 1:if(!(s<e.checkedList.length)){t.next=7;break}return t.next=4,e.judgeDelete(e.checkedList[s]);case 4:s++,t.next=1;break;case 7:e.canDelete?e.$confirm("此操作将永久删除当前用户信息与数据，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$store.commit("setDeleteList",e.checkedList),e.$store.dispatch("deleteMultiUser").then((function(t){200===t.data.code?(e.$store.commit("deleteMultiUser"),e.checkedList.splice(0,e.checkedList.length),e.$message({type:"success",message:"删除成功"})):e.$message({type:"error",message:"删除失败"})})).catch((function(){e.$message({type:"error",message:"系统错误"})}))})).catch((function(){e.$message({type:"info",message:"已取消操作"})})):!e.canDelete&&e.unableList.length>0?e.$alert("学号为  "+e.stringJoint(e.unableList)+"  的用户仍存在测试记录，请清理完毕后再进行操作"):e.$message({type:"error",message:"系统错误"}),e.unableList.splice(0,e.unableList.length),e.$store.commit("setTrue");case 10:case"end":return t.stop()}}),t)})))()},stopDefault:function(e){e.stopPropagation()}},created:function(){var e=this;this.$store.dispatch("getUserList",{process:1,page:1}).then((function(t){var s=t.data.data;s.records.length<=0?e.$message({message:"已经没有更多数据了哦",type:"warning"}):(e.$store.commit("initUserList",s),e.activeNum=e.userList[0].number.toString(),e.$store.dispatch("getRecordByNumber",e.userList[0].number.toString()).then((function(t){200===t.data.code?e.$store.commit("changeTableData",t.data.data):2001===t.data.code?e.$message({type:"info",message:"当前用户暂时没有测试数据"}):e.$message({type:"warning",message:"出错了"})})))})).catch((function(){e.$message({type:"error",message:"系统错误，已取消操作"})}))}}),E=B,V=(s("f197"),Object(h["a"])(E,O,N,!1,null,null,null)),M=V.exports;n["default"].use(_["a"]);var z=new _["a"]({routes:[{path:"/userList",component:P},{path:"/testList",component:M}]}),A=s("2f62"),J=function(e){return e.page},H=function(e){return e.currUser},Z=function(e){return e.userList},K=s("bc3a"),Y=s.n(K),G=function(e,t){switch(t.process){case 0:return Y()({method:"get",url:"/api/personnel/multi",params:{pageIndex:t.page.toString(),pageSize:"15"}});case 1:return Y()({method:"get",url:"/api/personnel/multi",params:{pageIndex:t.page.toString(),pageSize:"25"}})}},W=function(e,t){return Y()({method:"delete",url:"/api/personnel",params:{number:t}})},X=function(e,t){return Y()({method:"get",url:"/api/personnel/name",params:{name:t}})},ee=function(e,t){return Y()({method:"get",url:"/api/personnel/number/fuzzy",params:{number:t}})},te=function(e,t){return Y()({method:"put",url:"/api/personnel",data:t})},se=function(e,t){return Y()({method:"post",url:"/api/personnel",data:t})},re=function(e,t){return Y()({method:"get",url:"/api/record/personnel/number",params:{number:t}})},ae=function(e,t){return Y()({method:"get",url:"/api/report",params:{rid:t}})},ne=function(e,t){return Y()({method:"get",url:"/api/record/personnel",params:{pageIndex:t,pageSize:25}})},ie=function(e,t){return Y()({method:"delete",url:"/api/record",params:{rid:t}})},oe=function(e,t){return Y()({method:"delete",url:"/api/record/data",params:{rid:t}})},le=function(e,t){return Y()({method:"delete",url:"/api/report",params:{rid:t}})},ce=function(e,t){return Y()({method:"post",url:"/api/personnel/upload",data:t,headers:{"Content-type":"multipart/form-data"}})},ue=function(e,t){return Y()({method:"post",url:"/api/personnel/multi",params:{excelFileName:t}})},de=function(e){return console.log(e.state.deleteList),Y()({method:"delete",url:"/api/personnel/multi",data:e.state.deleteList})},me=(s("159b"),s("c740"),{initUserList:function(e,t){e.userList.length>0&&e.userList.splice(0,e.userList.length),pe(t.records,e.userList),e.totalPages=t.pages,e.isQuery=!1},changeUserList:function(e,t){e.userList.splice(0,e.userList.length),pe(t,e.userList)},changeTitle:function(e,t){switch(t){case 0:e.title="用户列表";break;case 1:e.title="测试列表";break;default:break}},deleteUser:function(e,t){var s=e.userList;s.some((function(e,r){if(e.number===t)return s.splice(r,1),!0}))},deleteRecord:function(e,t){var s;"tableData"===t.list?s=e.tableData:"recordList"===t.list&&(s=e.recordList),s.some((function(e,r){if(e.id===t.rid)return s.splice(r,1),!0}))},queryUsers:function(e,t){e.queryList.length>0&&e.queryList.splice(0,e.queryList.length),pe(t,e.queryList),e.queryPage=Math.floor(t.length/25),t.length%25>0&&e.queryPage++,e.queryIndex=1,ge(e,1),e.isQuery=!0,"测试列表"===e.title&&(e.showUser=!0)},showQueryList:function(e,t){ge(e,t)},updateUser:function(e,t){var s=e.userList;s.some((function(e){if(e.number===t.number)return e.nature=t.nature,e.age=t.age,e.sex=t.sex,e.timestamp=t.timestamp,!0}))},insertUser:function(e,t){var s=e.userList;s.unshift(t),s.pop()},changeTableData:function(e,t){pe(t,e.tableData)},clearTableData:function(e){he(e.tableData)},changeShowType:function(e){e.showUser=!e.showUser},initRecordList:function(e,t){e.recordList.length>0&&e.recordList.splice(0,e.recordList.length),pe(t.records,e.recordList),e.totalPages=t.pages,e.isQuery=!1},changeRecordList:function(e,t){e.recordList.splice(0,e.recordList.length),pe(t,e.recordList)},setDeleteList:function(e,t){e.deleteList.length>0&&he(e.deleteList),pe(t,e.deleteList)},setNumberList:function(e){e.numberList.length>0&&he(e.numberList),e.userList.forEach((function(t){e.numberList.push(t.number)}))},deleteMultiUser:function(e){for(var t=0;t<e.deleteList.length;t++){var s=e.deleteList[t];e.userList.splice(fe(e.userList,s),1)}},setFalse:function(e){e.canDelete=!1},setTrue:function(e){e.canDelete=!0}});function pe(e,t){var s=e.concat();while(s.length>0)t.push(s.pop());t.reverse()}function ge(e,t){e.userList.splice(0,e.userList.length);var s=25*(t-1),r=25*t-1,a=e.queryList,n=a.filter((function(e){return a.indexOf(e)>=s&&a.indexOf(e)<=r}));pe(n,e.userList)}function he(e){e.splice(0,e.length)}function fe(e,t){return e.findIndex((function(e){return e.number===t}))}n["default"].use(A["a"]);var ye={totalPages:null,currPage:null,userList:[],isQuery:!1,queryList:[],queryPage:null,queryIndex:null,currUser:{id:"",name:""},title:"用户列表",showUser:!0,tableData:[],recordList:[],deleteList:[],numberList:[],canDelete:!0},be=new A["a"].Store({state:ye,getters:r,actions:a,mutations:me});n["default"].config.productionTip=!1,n["default"].prototype.$axios=Y.a,n["default"].filter("dateFormat",(function(e){var t=new Date(e),s=t.getFullYear(),r=(t.getMonth()+1+"").padStart(2,"0"),a=(t.getDate()+"").padStart(2,"0"),n=(t.getHours()+"").padStart(2,"0"),i=(t.getMinutes()+"").padStart(2,"0"),o=(t.getSeconds()+"").padStart(2,"0");return"".concat(s,"-").concat(r,"-").concat(a," ").concat(n,":").concat(i,":").concat(o)})),n["default"].use(A["a"]),n["default"].use(z),n["default"].use(x.a),new n["default"]({router:z,store:be,render:function(e){return e(w)}}).$mount("#app")},"85ec":function(e,t,s){},"94cf":function(e,t,s){},b295:function(e,t,s){"use strict";s("f40d")},c166:function(e,t,s){},d5f1:function(e,t,s){"use strict";s("c166")},f197:function(e,t,s){"use strict";s("94cf")},f40d:function(e,t,s){}});
//# sourceMappingURL=app.527bd945.js.map